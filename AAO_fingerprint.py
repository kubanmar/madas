import json
from ase.data import atomic_numbers as an
from lxml import etree
from os.path import join
from scipy.special import sph_harm
import sys
import pymatgen
import matplotlib.pyplot as plt
import numpy as np

from fingerprint import Fingerprint

class AAOFingerprint(Fingerprint):

    def __init__(self, db_row = None):
        self._init_from_db_row(db_row)

    def calculate(self, db_row):
        atoms = db_row.toatoms()
        atom_list = [Atom(z, orbitals_dict = orbitals_dict) for z in atoms.get_atomic_numbers()]
        aao = self._calculate_averaged_orbitals(atom_list)
        self.averaged_states = aao

    def get_data(self):
        data = {'aao' : self.averaged_states.tolist()}
        return data

    def reconstruct(self, db_row):
        data = self._data_from_db_row(db_row)
        self.averaged_states = np.array(data['aao'])

    def _calculate_averaged_orbitals(self, atom_list):
        averaged_states = np.zeros(118)
        for atom in atom_list:
            for state in atom.states:
                state_id = ':'.join([str(state.n), str(state.l), str(state.m), str(state.occupied)])
                averaged_states[vector_dict[state_id]] += 1
        averaged_states /= len(atom_list)
        return averaged_states


def AAO_similarity(fingerprint1, fingerprint2):
    arr1 = fingerprint1.averaged_states
    arr2 = fingerprint2.averaged_states
    c = 0
    for d1, d2 in zip(arr1, arr2):
        if d1 != 0 and d2 != 0:
            c += 1 - abs(d1 - d2)
    a = sum([1 for x in arr1 if x != 0])
    b = sum([1 for x in arr2 if x != 0])
    tc = c/(a+b-c)
    return tc

## Helper classes and data

class State():

    """
    initialize with:
        ``occupied``: {None, 1, -1}, where 1 = 'up' and -1 = 'down'
        ``n``: principal quantum number
        ``l``,``m``: angular mumentum and magnetic quantum number
    """

    def __init__(self, occupied = False, n= 1, l = 0, m = 0):
        self.occupied = occupied
        self.n = n
        self.l = l
        self.m = m

    def spherical_harmonics(self, theta, phi):
        result = sph_harm(self.m, self.l, theta, phi).real
        return result

    def report(self):
        print('State (n,l,m,spin)',self.n,self.l,self.m,self.occupied)

class Shell():

    def __init__(self):
        self.states = []
        self.full = False
        self.n = None
        self.l = None

    def fill(self, n, l, occupation):
        n_states = self._get_size(l)
        self.n = int(n)
        self.l = int(l)
        for occ in range(occupation):
            if occ+1 <= n_states:
                occupied = 1
            else:
                occupied = -1
            m = int((occ % n_states) - int(n_states / 2))
            self.states.append(State(occupied = occupied, n = n, l = l, m = m))
        if occupation == 2*n_states:
            self.full = True

    def _get_size(self, l):
        if l == 0:
            n_states = 1
        elif l == 1:
            n_states = 3
        elif l == 2:
            n_states = 5
        elif l == 3:
            n_states = 7
        else:
            sys.exit('This does not exist. (l = '+str(l)+')')
        return n_states


class Atom():
    """
    initialize with:
        z: atomic number
    """

    def __init__(self, z, orbitals_dict = None):
        self.z = z
        self.states = []
        self.shells = []
        self.name = [name for name in an.keys()][z]
        if orbitals_dict != None:
            self.calc_states(orbitals_dict)

    def calc_states(self, orbitals_dict):
        orbitals = orbitals_dict[[x for x in an.keys()][self.z]]
        for n in orbitals.keys():
            for l in orbitals[n].keys():
                new_shell = Shell()
                new_shell.fill(int(n),int(l),orbitals[n][l])
                self.shells.append(new_shell)
        for shell in self.shells:
            for state in shell.states:
                self.states.append(state)

    def get_partially_filled_shells(self):
        shells = []
        for shell in self.shells:
            if shell.full == False:
                shells.append(shell)
        return shells

    def get_valence_states(self):
        valence_shells = self.get_partially_filled_shells()
        valence_states = []
        for shell in valence_shells:
            for state in shell.states:
                valence_states.append(state)
        return valence_states

    def get_all_the_similarities(self, orbitals_dict):
        out_dict = {}
        for other_z in range(1,115):
            try:
                atom = Atom(other_z, orbitals_dict)
            except KeyError:
                continue
            tc = atom_similarity(self, atom)
            out_dict[atom.name] = tc
        return out_dict

    @staticmethod
    def plot_all_the_similarities(in_dict, show = True):
        pymatgen.util.plotting.periodic_table_heatmap(in_dict)
        if show:
            plt.show()


vector_dict = json.loads('{"1:0:0:1": 0, "1:0:0:-1": 1, "2:0:0:1": 2, "2:0:0:-1": 3, "2:1:-1:1": 4, "2:1:0:1": 5, "2:1:1:1": 6, "2:1:-1:-1": 7, "2:1:0:-1": 8, "2:1:1:-1": 9, "3:0:0:1": 10, "3:0:0:-1": 11, "3:1:-1:1": 12, "3:1:0:1": 13, "3:1:1:1": 14, "3:1:-1:-1": 15, "3:1:0:-1": 16, "3:1:1:-1": 17, "3:2:-2:1": 18, "3:2:-1:1": 19, "3:2:0:1": 20, "3:2:1:1": 21, "3:2:2:1": 22, "3:2:-2:-1": 23, "3:2:-1:-1": 24, "3:2:0:-1": 25, "3:2:1:-1": 26, "3:2:2:-1": 27, "4:0:0:1": 28, "4:0:0:-1": 29, "4:1:-1:1": 30, "4:1:0:1": 31, "4:1:1:1": 32, "4:1:-1:-1": 33, "4:1:0:-1": 34, "4:1:1:-1": 35, "4:2:-2:1": 36, "4:2:-1:1": 37, "4:2:0:1": 38, "4:2:1:1": 39, "4:2:2:1": 40, "4:2:-2:-1": 41, "4:2:-1:-1": 42, "4:2:0:-1": 43, "4:2:1:-1": 44, "4:2:2:-1": 45, "4:3:-3:1": 46, "4:3:-2:1": 47, "4:3:-1:1": 48, "4:3:0:1": 49, "4:3:1:1": 50, "4:3:2:1": 51, "4:3:3:1": 52, "4:3:-3:-1": 53, "4:3:-2:-1": 54, "4:3:-1:-1": 55, "4:3:0:-1": 56, "4:3:1:-1": 57, "4:3:2:-1": 58, "4:3:3:-1": 59, "5:0:0:1": 60, "5:0:0:-1": 61, "5:1:-1:1": 62, "5:1:0:1": 63, "5:1:1:1": 64, "5:1:-1:-1": 65, "5:1:0:-1": 66, "5:1:1:-1": 67, "5:2:-2:1": 68, "5:2:-1:1": 69, "5:2:0:1": 70, "5:2:1:1": 71, "5:2:2:1": 72, "5:2:-2:-1": 73, "5:2:-1:-1": 74, "5:2:0:-1": 75, "5:2:1:-1": 76, "5:2:2:-1": 77, "5:3:-3:1": 78, "5:3:-2:1": 79, "5:3:-1:1": 80, "5:3:0:1": 81, "5:3:1:1": 82, "5:3:2:1": 83, "5:3:3:1": 84, "5:3:-3:-1": 85, "5:3:-2:-1": 86, "5:3:-1:-1": 87, "5:3:0:-1": 88, "5:3:1:-1": 89, "5:3:2:-1": 90, "5:3:3:-1": 91, "6:0:0:1": 92, "6:0:0:-1": 93, "6:1:-1:1": 94, "6:1:0:1": 95, "6:1:1:1": 96, "6:1:-1:-1": 97, "6:1:0:-1": 98, "6:1:1:-1": 99, "6:2:-2:1": 100, "6:2:-1:1": 101, "6:2:0:1": 102, "6:2:1:1": 103, "6:2:2:1": 104, "6:2:-2:-1": 105, "6:2:-1:-1": 106, "6:2:0:-1": 107, "6:2:1:-1": 108, "6:2:2:-1": 109, "7:0:0:1": 110, "7:0:0:-1": 111, "7:1:-1:1": 112, "7:1:0:1": 113, "7:1:1:1": 114, "7:1:-1:-1": 115, "7:1:0:-1": 116, "7:1:1:-1": 117}')

orbitals_dict = json.loads('{"H": {"1": {"0": 1}}, "He": {"1": {"0": 2}}, "Li": {"1": {"0": 2}, "2": {"0": 1}}, "Be": {"1": {"0": 2}, "2": {"0": 2}}, "B": {"1": {"0": 2}, "2": {"0": 2, "1": 1}}, "C": {"1": {"0": 2}, "2": {"0": 2, "1": 2}}, "N": {"1": {"0": 2}, "2": {"0": 2, "1": 3}}, "O": {"1": {"0": 2}, "2": {"0": 2, "1": 4}}, "F": {"1": {"0": 2}, "2": {"0": 2, "1": 5}}, "Ne": {"1": {"0": 2}, "2": {"0": 2, "1": 6}}, "Na": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 1}}, "Mg": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2}}, "Al": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 1}}, "Si": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 2}}, "P": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 3}}, "S": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 4}}, "Cl": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 5}}, "Ar": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6}}, "K": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6}, "4": {"0": 1}}, "Ca": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6}, "4": {"0": 2}}, "Sc": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 1}, "4": {"0": 2}}, "Ti": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 2}, "4": {"0": 2}}, "V": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 3}, "4": {"0": 2}}, "Cr": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 5}, "4": {"0": 1}}, "Mn": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 5}, "4": {"0": 2}}, "Fe": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 6}, "4": {"0": 2}}, "Co": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 7}, "4": {"0": 2}}, "Ni": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 8}, "4": {"0": 2}}, "Cu": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 1}}, "Zn": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2}}, "Ga": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 1}}, "Ge": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 2}}, "As": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 3}}, "Se": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 4}}, "Br": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 5}}, "Kr": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6}}, "Rb": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6}, "5": {"0": 1}}, "Sr": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6}, "5": {"0": 2}}, "Y": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 1}, "5": {"0": 2}}, "Zr": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 2}, "5": {"0": 2}}, "Nb": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 4}, "5": {"0": 1}}, "Mo": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 5}, "5": {"0": 1}}, "Tc": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 6}, "5": {"0": 1}}, "Ru": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 7}, "5": {"0": 1}}, "Rh": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 8}, "5": {"0": 1}}, "Pd": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10}}, "Ag": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10}, "5": {"0": 1}}, "Cd": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10}, "5": {"0": 2}}, "In": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10}, "5": {"0": 2, "1": 1}}, "Sn": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10}, "5": {"0": 2, "1": 2}}, "Sb": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10}, "5": {"0": 2, "1": 3}}, "Te": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10}, "5": {"0": 2, "1": 4}}, "I": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10}, "5": {"0": 2, "1": 5}}, "Xe": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10}, "5": {"0": 2, "1": 6}}, "Cs": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10}, "5": {"0": 2, "1": 6}, "6": {"0": 1}}, "Ba": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10}, "5": {"0": 2, "1": 6}, "6": {"0": 2}}, "La": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10}, "5": {"0": 2, "1": 6, "2": 1}, "6": {"0": 2}}, "Ce": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 2}, "5": {"0": 2, "1": 6}, "6": {"0": 2}}, "Pr": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 3}, "5": {"0": 2, "1": 6}, "6": {"0": 2}}, "Nd": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 4}, "5": {"0": 2, "1": 6}, "6": {"0": 2}}, "Pm": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 5}, "5": {"0": 2, "1": 6}, "6": {"0": 2}}, "Sm": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 6}, "5": {"0": 2, "1": 6}, "6": {"0": 2}}, "Eu": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 7}, "5": {"0": 2, "1": 6}, "6": {"0": 2}}, "Gd": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 7}, "5": {"0": 2, "1": 6, "2": 1}, "6": {"0": 2}}, "Tb": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 9}, "5": {"0": 2, "1": 6}, "6": {"0": 2}}, "Dy": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 10}, "5": {"0": 2, "1": 6}, "6": {"0": 2}}, "Ho": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 11}, "5": {"0": 2, "1": 6}, "6": {"0": 2}}, "Er": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 12}, "5": {"0": 2, "1": 6}, "6": {"0": 2}}, "Tm": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 13}, "5": {"0": 2, "1": 6}, "6": {"0": 2}}, "Yb": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6}, "6": {"0": 2}}, "Lu": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 1}, "6": {"0": 2}}, "Hf": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 2}, "6": {"0": 2}}, "Ta": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 3}, "6": {"0": 2}}, "W": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 4}, "6": {"0": 2}}, "Re": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 5}, "6": {"0": 2}}, "Os": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 6}, "6": {"0": 2}}, "Ir": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 7}, "6": {"0": 2}}, "Pt": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 9}, "6": {"0": 1}}, "Au": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10}, "6": {"0": 1}}, "Hg": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10}, "6": {"0": 2}}, "Tl": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10}, "6": {"0": 2, "1": 1}}, "Pb": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10}, "6": {"0": 2, "1": 2}}, "Bi": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10}, "6": {"0": 2, "1": 3}}, "Po": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10}, "6": {"0": 2, "1": 4}}, "At": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10}, "6": {"0": 2, "1": 5}}, "Rn": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10}, "6": {"0": 2, "1": 6}}, "Fr": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10}, "6": {"0": 2, "1": 6}, "7": {"0": 1}}, "Ra": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10}, "6": {"0": 2, "1": 6}, "7": {"0": 2}}, "Ac": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10}, "6": {"0": 2, "1": 6, "2": 1}, "7": {"0": 2}}, "Th": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10}, "6": {"0": 2, "1": 6, "2": 2}, "7": {"0": 2}}, "Pa": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10, "3": 2}, "6": {"0": 2, "1": 6, "2": 1}, "7": {"0": 2}}, "U": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10, "3": 3}, "6": {"0": 2, "1": 6, "2": 1}, "7": {"0": 2}}, "Np": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10, "3": 4}, "6": {"0": 2, "1": 6, "2": 1}, "7": {"0": 2}}, "Pu": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10, "3": 6}, "6": {"0": 2, "1": 6}, "7": {"0": 2}}, "Am": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10, "3": 7}, "6": {"0": 2, "1": 6}, "7": {"0": 2}}, "Cm": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10, "3": 7}, "6": {"0": 2, "1": 6, "2": 1}, "7": {"0": 2}}, "Bk": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10, "3": 9}, "6": {"0": 2, "1": 6}, "7": {"0": 2}}, "Cf": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10, "3": 10}, "6": {"0": 2, "1": 6}, "7": {"0": 2}}, "Es": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10, "3": 11}, "6": {"0": 2, "1": 6}, "7": {"0": 2}}, "Fm": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10, "3": 12}, "6": {"0": 2, "1": 6}, "7": {"0": 2}}, "Md": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10, "3": 13}, "6": {"0": 2, "1": 6}, "7": {"0": 2}}, "No": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10, "3": 14}, "6": {"0": 2, "1": 6}, "7": {"0": 2}}, "Lr": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10, "3": 14}, "6": {"0": 2, "1": 6, "2": 1}, "7": {"0": 2}}, "Rf": {"1": {"0": 2}, "2": {"0": 2, "1": 6}, "3": {"0": 2, "1": 6, "2": 10}, "4": {"0": 2, "1": 6, "2": 10, "3": 14}, "5": {"0": 2, "1": 6, "2": 10, "3": 14}, "6": {"0": 2, "1": 6, "2": 2}, "7": {"0": 2}}}')
